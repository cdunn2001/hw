Extract sts.h5

  $ outPrefix="softball_snr-50"
  $ bazFile="/pbi/dept/primary/sim/spider/kestrel-test-new-header-zmw-info/prod.baz"
  $ baz2bam --fullHQ -o ${outPrefix} -m $TESTDIR/data/metadata.xml ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1634,1634,1,1,4294967295,1634,1,0,0.8,0,1634,0,532,0.8,2.971,0.199586,0.129843,3.0363,1582,2.971,0.199586,0.000611995,0,4294967295,nan,0.24847/0.239902/0.252754/0.258874,5.1685/7.4737/2.02619/3.27248,5.1685/7.4737/2.02619/3.27248,185.42/268.119/72.6896/117.4,1/0/0/0,1634/0/0/0,-18.4688,35.875,-18.4688,35.875,-1/-1/-1/-1,2.06225,0/0,0,0,0
  1677,1677,1,1,4294967295,1677,1,0,0.8,0,1677,0,532,0.8,3.05927,0.190712,0.129843,3.12035,1629,3.05927,0.190712,0.000596303,0,4294967295,nan,0.248658/0.22898/0.274299/0.248062,4.39819/6.41331/1.73526/2.78332,4.39819/6.41331/1.73526/2.78332,184.037/268.357/72.6097/116.464,1/0/0/0,1677/0/0/0,-2.30469,41.8438,-2.30469,41.8438,-1/-1/-1/-1,1.84885,0/0,1,0,0
  1647,1647,1,1,4294967295,1647,1,0,0.8,0,1647,0,532,0.8,2.98039,0.199687,0.115416,3.17428,1587,2.98039,0.199687,0.000607165,0,4294967295,nan,0.258652/0.237401/0.250152/0.253795,4.64157/6.80619/1.8066/2.92614,4.64157/6.80619/1.8066/2.92614,184.212/270.121/71.6996/116.131,1/0/0/0,1647/0/0/0,-10.6016,39.6875,-10.6016,39.6875,-1/-1/-1/-1,1.93373,0/0,2,0,0
  1603,1603,1,1,4294967295,1603,1,0,0.8,0,1603,0,532,0.8,2.89776,0.20571,0.14427,2.85804,1543,2.89776,0.20571,0.00062383,0,4294967295,nan,0.262009/0.266999/0.230817/0.240175,5.84951/8.5586/2.25124/3.66859,5.84951/8.5586/2.25124/3.66859,184.899/270.532/71.1603/115.962,1/0/0/0,1603/0/0/0,-18.9062,31.6094,-18.9062,31.6094,-1/-1/-1/-1,2.39997,0/0,3,0,0
  $ stsTool ${outPrefix}.sts.h5 | tail -5
  1651,1651,1,1,4294967295,1651,1,0,0.8,0,1651,0,532,0.8,3.03486,0.191516,0.129843,3.11255,1616,3.03486,0.191516,0.000605693,0,4294967295,nan,0.247123/0.245912/0.264688/0.242277,5.43196/8.01435/2.11006/3.45342,5.43196/8.01435/2.11006/3.45342,183.668/270.985/71.3464/116.769,1/0/0/0,1651/0/0/0,-12.4531,33.8125,-12.4531,33.8125,-1/-1/-1/-1,2.48563,0/0,195,0,0
  1640,1640,1,1,4294967295,1640,1,0,0.8,0,1640,0,532,0.8,2.98227,0.196055,0.129843,3.06919,1588,2.98227,0.196055,0.000609756,0,4294967295,nan,0.232317/0.24878/0.255488/0.263415,5.63131/8.22509/2.18743/3.52472,5.63131/8.22509/2.18743/3.52472,186.009/271.685/72.2534/116.426,1/0/0/0,1640/0/0/0,-14.2109,33.0312,-14.2109,33.0312,-1/-1/-1/-1,2.50887,0/0,196,0,0
  1603,1603,1,1,4294967295,1603,1,0,0.8,0,1603,0,532,0.8,2.91279,0.206866,0.129843,2.97065,1551,2.91279,0.206866,0.00062383,0,4294967295,nan,0.243918/0.243918/0.25577/0.256394,3.80233/5.58102/1.48542/2.42578,3.80233/5.58102/1.48542/2.42578,183.819/269.807/71.8107/117.271,1/0/0/0,1603/0/0/0,-16.875,48.3438,-16.875,48.3438,-1/-1/-1/-1,1.57032,0/0,197,0,0
  1630,1630,1,1,4294967295,1630,1,0,0.8,0,1630,0,532,0.8,2.97852,0.201914,0.129843,3.01498,1586,2.97852,0.201914,0.000613497,0,4294967295,nan,0.246626/0.24908/0.24908/0.255215,5.87264/8.69572/2.29989/3.72899,5.87264/8.69572/2.29989/3.72899,182.97/270.926/71.6561/116.181,1/0/0/0,1630/0/0/0,-17.7344,31.1562,-17.7344,31.1562,-1/-1/-1/-1,2.53549,0/0,198,0,0
  1628,1628,1,1,4294967295,1628,1,0,0.8,0,1628,0,532,0.8,2.96161,0.201821,0.129843,3.01583,1577,2.96161,0.201821,0.000614251,0,4294967295,nan,0.263514/0.230344/0.255528/0.250614,3.812/5.61653/1.48449/2.39084,3.812/5.61653/1.48449/2.39084,184.286/271.524/71.7657/115.582,1/0/0/0,1628/0/0/0,-17.7031,48.3438,-17.7031,48.3438,-1/-1/-1/-1,1.60662,0/0,199,0,0

Extract sts.h5

  $ baz2bam -Q $TESTDIR/data/hqregions.fasta -o ${outPrefix}-2 -m $TESTDIR/data/metadata.xml ${bazFile} --silent  --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}-2.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1634,500,2,2,4294967295,500,3,0,0,500,1000,163,327,0,2.98462,0.198797,0.14427,2.91734,489,2.98462,0.198797,0,0,4294967295,nan,0.242/0.244/0.266/0.248,5.19371/7.47519/2.02524/3.26142,5.1685/7.4737/2.02619/3.27248,186.324/268.172/72.6553/117.003,1/0/0/0,1634/0/0/0,-17.2344,35.875,-18.4688,35.875,-1/-1/-1/-1,2.08787,0/0,0,0,0
  1677,500,2,2,4294967295,500,3,0,0,500,1000,163,327,0,3.03345,0.191927,0.14427,2.977,497,3.03345,0.191927,0,0,4294967295,nan,0.274/0.236/0.262/0.228,4.43687/6.48754/1.72401/2.78513,4.39819/6.41331/1.73526/2.78332,185.655/271.463/72.139/116.54,1/0/0/0,1677/0/0/0,-2.19141,41.8438,-2.30469,41.8438,-1/-1/-1/-1,1.79472,0/0,1,0,0
  1647,500,2,2,4294967295,500,3,0,0,500,1000,163,327,0,3.03955,0.202445,0.115416,3.14832,498,3.03955,0.202445,0,0,4294967295,nan,0.238/0.226/0.24/0.296,4.57777/6.82668/1.77195/2.87379,4.64157/6.80619/1.8066/2.92614,181.68/270.934/70.3242/114.054,1/0/0/0,1647/0/0/0,-7.17188,39.6875,-10.6016,39.6875,-1/-1/-1/-1,1.84717,0/0,2,0,0
  1603,500,2,2,4294967295,500,3,0,0,500,1000,163,327,0,2.88086,0.210533,0.14427,2.82076,472,2.88086,0.210533,0,0,4294967295,nan,0.238/0.262/0.234/0.266,5.80273/8.51206/2.21626/3.60065,5.84951/8.5586/2.25124/3.66859,183.421/269.061/70.0546/113.814,1/0/0/0,1603/0/0/0,-17.7656,31.6094,-18.9062,31.6094,-1/-1/-1/-1,2.34887,0/0,3,0,0
  $ stsTool ${outPrefix}-2.sts.h5 | tail -5
  1651,500,2,2,4294967295,500,3,0,0,500,1000,122,286,0,3.01514,0.190125,0.129843,3.12786,494,3.01514,0.190125,0,0,4294967295,nan,0.282/0.24/0.23/0.248,5.75174/8.47683/2.25356/3.63758,5.43196/8.01435/2.11006/3.45342,183.337/270.199/71.8323/115.948,1/0/0/0,1651/0/0/0,-8.28906,31.875,-12.4531,33.8125,-1/-1/-1/-1,2.38354,0/0,195,0,0
  1640,500,2,2,4294967295,500,3,0,0,500,1000,163,327,0,2.89307,0.200198,0.14427,2.90546,474,2.89307,0.200198,0,0,4294967295,nan,0.26/0.262/0.252/0.226,5.58455/8.22806/2.16686/3.53265,5.63131/8.22509/2.18743/3.52472,184.465/271.783/71.5742/116.688,1/0/0/0,1640/0/0/0,-12.6797,33.0312,-14.2109,33.0312,-1/-1/-1/-1,2.29455,0/0,196,0,0
  1603,500,2,2,4294967295,500,3,0,0,500,1000,163,327,0,3.04565,0.197419,0.129843,3.05809,499,3.04565,0.197419,0,0,4294967295,nan,0.258/0.226/0.276/0.24,3.80431/5.59164/1.4821/2.4034,3.80233/5.58102/1.48542/2.42578,183.914/270.321/71.6502/116.19,1/0/0/0,1603/0/0/0,-11.8125,48.3438,-16.875,48.3438,-1/-1/-1/-1,1.56245,0/0,197,0,0
  1630,500,2,2,4294967295,500,3,0,0,500,1000,163,327,0,2.97852,0.20585,0.129843,2.98123,488,2.97852,0.20585,0,0,4294967295,nan,0.242/0.232/0.24/0.286,5.85274/8.6716/2.27005/3.69955,5.87264/8.69572/2.29989/3.72899,182.349/270.174/70.7263/115.264,1/0/0/0,1630/0/0/0,-12.8438,31.1562,-17.7344,31.1562,-1/-1/-1/-1,2.37648,0/0,198,0,0
  1628,500,2,2,4294967295,500,3,0,0,500,1000,163,327,0,2.91138,0.204812,0.129843,2.99047,477,2.91138,0.204812,0,0,4294967295,nan,0.268/0.21/0.256/0.266,3.81809/5.626/1.46545/2.41195,3.812/5.61653/1.48449/2.39084,184.581/271.982/70.8455/116.603,1/0/0/0,1628/0/0/0,-11.2266,48.3438,-17.7031,48.3438,-1/-1/-1/-1,1.56378,0/0,199,0,0

Run with diagnostic datasets turned on

  $ outPrefix="softball_snr-50_diag"
  $ baz2bam --fullHQ --diagStsH5 -o ${outPrefix} -m $TESTDIR/data/metadata.xml --adapters $TESTDIR/data/adapter.fasta ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

  $ h5ls ${outPrefix}.sts.h5/VsMF
  BaseRate                 Dataset {200, 15}
  BaseWidth                Dataset {200, 15}
  BaselineLevel            Dataset {200, 15, 1}
  BaselineStd              Dataset {200, 15, 1}
  NumFrames                Dataset {200, 15}
  Pkmid                    Dataset {200, 15, 4}
  PulseRate                Dataset {200, 15}
  PulseWidth               Dataset {200, 15}
  SnrMean                  Dataset {200, 15, 4}
  TraceAutoCorr            Dataset {200, 15}
