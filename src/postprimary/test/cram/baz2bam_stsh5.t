Extract sts.h5

  $ outPrefix="softball_snr-50"
  $ bazFile="/pbi/dept/primary/sim/kestrel/kestrel-test-metrics/prod.baz"
  $ baz2bam --fullHQ -o ${outPrefix} -m $TESTDIR/data/metadata.xml ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1623,1623,1,1,4294967295,1623,1,0,0.8,0,1623,0,532,0.8,2.89401,0.201698,0.129843,3.01695,1555,2.9203,0.20005,0.000616143,0,4294967295,nan,0.252619/0.244609/0.245225/0.257548,12.9295/17.9326/5.13264/8.18988,12.9295/17.9326/5.13264/8.18988,185.357/257.081/73.5813/117.41,1/0/0/0,1623/0/0/0,-1.16406,14.3359,-1.16406,14.3359,-1/-1/-1/-1,4.84448,0/0,0,1,0
  1655,1655,1,1,4294967295,1655,1,0,0.8,0,1655,0,532,0.8,2.95786,0.19284,0.129843,3.09977,1585,2.97664,0.191756,0.00060423,0,4294967295,nan,0.253776/0.236858/0.265257/0.244109,12.8402/18.0655/5.07609/8.09765,12.8402/18.0655/5.07609/8.09765,185.18/260.539/73.2068/116.783,1/0/0/0,1655/0/0/0,-0.503906,14.4219,-0.503906,14.4219,-1/-1/-1/-1,5.00269,0/0,1,1,0
  1631,1631,1,1,4294967295,1631,1,0,0.8,0,1631,0,532,0.8,2.89401,0.201243,0.129843,3.0211,1553,2.91654,0.199895,0.000613121,0,4294967295,nan,0.260576/0.242183/0.242183/0.255058,12.8794/18.3496/5.06428/8.11189,12.8794/18.3496/5.06428/8.11189,184.538/262.915/72.5616/116.228,1/0/0/0,1631/0/0/0,-2.03516,14.3281,-2.03516,14.3281,-1/-1/-1/-1,5.0769,0/0,2,1,0
  1589,1589,1,1,4294967295,1589,1,0,0.8,0,1589,0,532,0.8,2.81701,0.206296,0.14427,2.85327,1511,2.83767,0.204994,0.000629327,0,4294967295,nan,0.264947/0.271869/0.221523/0.241661,13.0132/18.9315/5.09749/8.15952,13.0132/18.9315/5.09749/8.15952,184.523/268.443/72.2809/115.7,1/0/0/0,1589/0/0/0,-2.08594,14.1797,-2.08594,14.1797,-1/-1/-1/-1,5.12464,0/0,3,1,0
  $ stsTool ${outPrefix}.sts.h5 | tail -5
  1647,1647,1,1,4294967295,1647,1,0,0.8,0,1647,0,532,0.8,2.971,0.191633,0.129843,3.11142,1593,2.99166,0.190346,0.000607165,0,4294967295,nan,0.250759/0.24833/0.256831/0.24408,13.0247/19.2202/5.1153/8.23217,13.0247/19.2202/5.1153/8.23217,184.28/271.935/72.3735/116.472,1/0/0/0,1647/0/0/0,-1.91895,14.1484,-1.91895,14.1484,-1/-1/-1/-1,5.0329,0/0,195,1,0
  1619,1619,1,1,4294967295,1619,1,0,0.8,0,1619,0,532,0.8,2.89588,0.197419,0.14427,2.92741,1563,2.93532,0.195045,0.000617665,0,4294967295,nan,0.235948/0.254478/0.244595/0.264978,12.9453/19.083/5.13128/8.19974,12.9453/19.083/5.13128/8.19974,185.28/273.125/73.4415/117.359,1/0/0/0,1619/0/0/0,-0.523438,14.3125,-0.523438,14.3125,-1/-1/-1/-1,5.15645,0/0,196,1,0
  1601,1601,1,1,4294967295,1601,1,0,0.8,0,1601,0,532,0.8,2.86396,0.205853,0.129843,2.97961,1534,2.88086,0.204698,0.00062461,0,4294967295,nan,0.244222/0.249844/0.248595/0.257339,12.5986/18.0784/4.9924/8.0774,12.5986/18.0784/4.9924/8.0774,183.074/262.702/72.5459/117.375,1/0/0/0,1601/0/0/0,-2.60352,14.5312,-2.60352,14.5312,-1/-1/-1/-1,4.79721,0/0,197,1,0
  1612,1612,1,1,4294967295,1612,1,0,0.8,0,1612,0,532,0.8,2.88649,0.203566,0.129843,3.00005,1551,2.91279,0.201934,0.000620347,0,4294967295,nan,0.247519/0.256203/0.238834/0.257444,12.8796/19.0793/5.07372/8.13705,12.8796/19.0793/5.07372/8.13705,183.836/272.327/72.4194/116.144,1/0/0/0,1612/0/0/0,-2.07812,14.2734,-2.07812,14.2734,-1/-1/-1/-1,5.07543,0/0,198,1,0
  1623,1623,1,1,4294967295,1623,1,0,0.8,0,1623,0,532,0.8,2.89213,0.202184,0.129843,3.01254,1553,2.91654,0.200674,0.000616143,0,4294967295,nan,0.260012/0.236599/0.255083/0.248306,12.9334/19.0891/5.05452/8.14771,12.9334/19.0891/5.05452/8.14771,184.301/272.019/72.027/116.105,1/0/0/0,1623/0/0/0,-1.8457,14.25,-1.8457,14.25,-1/-1/-1/-1,4.9134,0/0,199,1,0

Extract sts.h5

  $ baz2bam -Q $TESTDIR/data/hqregions.fasta -o ${outPrefix}-2 -m $TESTDIR/data/metadata.xml ${bazFile} --silent  --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}-2.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1623,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.93579,0.203584,0.14427,2.87716,484,2.9541,0.202453,0,0,4294967295,nan,0.246/0.248/0.256/0.25,13.2501/17.2806/5.20368/8.36908,12.9295/17.9326/5.13264/8.18988,186.847/243.684/73.38/118.017,1/0/0/0,1623/0/0/0,-0.661621,14.1016,-1.16406,14.3359,-1/-1/-1/-1,5.11618,0/0,0,1,0
  1655,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.00293,0.192726,0.14427,2.96994,494,3.01514,0.192111,0,0,4294967295,nan,0.276/0.24/0.262/0.222,12.706/18.5548/4.97352/7.96655,12.8402/18.0655/5.07609/8.09765,186.619/272.524/73.0486/117.009,1/0/0/0,1655/0/0/0,0.0878296,14.6875,-0.503906,14.4219,-1/-1/-1/-1,5.04277,0/0,1,1,0
  1631,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.00903,0.204669,0.129843,2.99176,496,3.02734,0.203707,0,0,4294967295,nan,0.238/0.232/0.228/0.302,12.715/18.8916/4.93761/7.98425,12.8794/18.3496/5.06428/8.11189,182.679/271.419/70.9395/114.711,1/0/0/0,1631/0/0/0,-2.20898,14.3672,-2.03516,14.3281,-1/-1/-1/-1,4.99501,0/0,2,1,0
  1589,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.89917,0.207824,0.14427,2.84248,477,2.91138,0.207062,0,0,4294967295,nan,0.246/0.268/0.228/0.258,12.8055/18.7304/4.92266/7.94453,13.0132/18.9315/5.09749/8.15952,184.279/269.542/70.8402/114.327,1/0/0/0,1589/0/0/0,-3.01172,14.3906,-2.08594,14.1797,-1/-1/-1/-1,5.02706,0/0,3,1,0
  $ stsTool ${outPrefix}-2.sts.h5 | tail -5
  1647,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.04565,0.188284,0.129843,3.14597,500,3.05176,0.188001,0,0,4294967295,nan,0.288/0.242/0.218/0.252,13.0419/19.2055/5.11931/8.23179,13.0247/19.2202/5.1153/8.23217,184.522/271.728/72.4303/116.467,1/0/0/0,1647/0/0/0,-1.91895,14.1484,-1.91895,14.1484,-1/-1/-1/-1,5.10702,0/0,195,1,0
  1619,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.85034,0.199934,0.14427,2.90769,475,2.89917,0.197022,0,0,4294967295,nan,0.264/0.26/0.242/0.234,12.8798/18.9048/5.01791/8.14776,12.9453/19.083/5.13128/8.19974,185.55/272.347/72.2892/117.379,1/0/0/0,1619/0/0/0,-0.959473,14.4062,-0.523438,14.3125,-1/-1/-1/-1,5.1728,0/0,196,1,0
  1601,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.06396,0.198289,0.129843,3.04997,504,3.07617,0.197501,0,0,4294967295,nan,0.254/0.234/0.274/0.238,12.0433/17.0731/4.77137/7.64863,12.5986/18.0784/4.9924/8.0774,182.907/259.297/72.4651/116.164,1/0/0/0,1601/0/0/0,-1.04395,15.1875,-2.60352,14.5312,-1/-1/-1/-1,4.51713,0/0,197,1,0
  1612,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.96631,0.204427,0.129843,2.99392,491,2.99683,0.202613,0,0,4294967295,nan,0.246/0.238/0.228/0.288,12.4228/18.3541/4.8743/7.8541,12.8796/19.0793/5.07372/8.13705,183.721/271.439/72.0864/116.155,1/0/0/0,1612/0/0/0,-2.07812,14.7891,-2.07812,14.2734,-1/-1/-1/-1,4.87076,0/0,198,1,0
  1623,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.88696,0.208607,0.129843,2.95692,477,2.91138,0.207032,0,0,4294967295,nan,0.268/0.218/0.256/0.258,12.6869/18.6473/4.90759/8.07002,12.9334/19.0891/5.05452/8.14771,184.654/271.406/71.4285/117.457,1/0/0/0,1623/0/0/0,-1.87012,14.5547,-1.8457,14.25,-1/-1/-1/-1,4.71632,0/0,199,1,0

Run with diagnostic datasets turned on

  $ outPrefix="softball_snr-50_diag"
  $ baz2bam --fullHQ --diagStsH5 -o ${outPrefix} -m $TESTDIR/data/metadata.xml --adapters $TESTDIR/data/adapter.fasta ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

  $ h5ls ${outPrefix}.sts.h5/VsMF
  BaseRate                 Dataset {200, 15}
  BaseWidth                Dataset {200, 15}
  BaselineLevel            Dataset {200, 15, 1}
  BaselineStd              Dataset {200, 15, 1}
  NumFrames                Dataset {200, 15}
  Pkmid                    Dataset {200, 15, 4}
  PulseRate                Dataset {200, 15}
  PulseWidth               Dataset {200, 15}
  SnrMean                  Dataset {200, 15, 4}
  TraceAutoCorr            Dataset {200, 15}
