Extract sts.h5

  $ outPrefix="softball_snr-50"
  $ bazFile="/pbi/dept/primary/sim/kestrel/kestrel-zmw-features.RTO2/prod.baz"
  $ baz2bam --fullHQ -o ${outPrefix} -m $TESTDIR/data/metadata.xml ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1378,1378,1,1,4294967295,1378,1,0,0.8,0,1378,0,450,0.8,2.8742,0.199579,0.129843,3.03649,1301,2.88752,0.198756,0.000725689,0,4294967295,nan,0.261974/0.246009/0.233672/0.258345,13.0751/17.8369/5.12589/8.19394,13.0751/17.8369/5.12589/8.19394,185.912/253.619/72.8837/116.508,1/0/0/0,1378/0/0/0,-0.953125,14.2188,-0.953125,14.2188,-1/-1/-1/-1,5.08098,0/0,0,1,1
  1391,1391,1,1,4294967295,1391,1,0,0.8,0,1391,0,450,0.8,2.91193,0.195676,0.129843,3.0729,1315,2.91859,0.195293,0.000718907,0,4294967295,nan,0.259526/0.238677/0.257369/0.244428,12.8267/18.3323/5.03279/8.0464,12.8267/18.3323/5.03279/8.0464,185.186/264.673/72.6609/116.17,1/0/0/0,1391/0/0/0,-1.9707,14.4375,-1.9707,14.4375,-1/-1/-1/-1,5.03559,1/0,1,1,1
  1387,1387,1,1,4294967295,1387,1,0,0.8,0,1387,0,450,0.8,2.88086,0.201984,0.129843,3.01447,1302,2.88974,0.201405,0.000720981,0,4294967295,nan,0.251622/0.238645/0.243691/0.266042,13.0448/18.4117/5.15729/8.28449,13.0448/18.4117/5.15729/8.28449,184.258/260.066/72.8467/117.018,1/0/0/0,1387/0/0/0,-0.791992,14.125,-0.791992,14.125,-1/-1/-1/-1,5.10782,2/0,2,1,1
  1347,1347,1,1,4294967295,1347,1,0,0.8,0,1347,0,450,0.8,2.79652,0.205926,0.14427,2.85642,1264,2.8054,0.205342,0.000742391,0,4294967295,nan,0.276169/0.269488/0.216778/0.237565,12.9646/18.8006/5.07691/8.2133,12.9646/18.8006/5.07691/8.2133,184.947/268.203/72.4252/117.168,1/0/0/0,1347/0/0/0,-1.63867,14.2656,-1.63867,14.2656,-1/-1/-1/-1,5.08294,3/0,3,1,1
  $ stsTool ${outPrefix}.sts.h5 | tail -5
  1384,1384,1,1,4294967295,1384,1,0,0.8,0,1384,0,450,0.8,2.92747,0.196084,0.14427,2.93902,1320,2.92969,0.195934,0.000722543,0,4294967295,nan,0.256503/0.251445/0.252168/0.239884,13.0103/19.1657/5.10583/8.20566,13.0103/19.1657/5.10583/8.20566,184.787/272.213/72.5188/116.546,1/0/0/0,1384/0/0/0,-1.52637,14.2031,-1.52637,14.2031,-1/-1/-1/-1,5.09096,3/3,195,1,1
  1365,1365,1,1,4294967295,1365,1,0,0.8,0,1365,0,450,0.8,2.85645,0.197662,0.14427,2.92546,1294,2.87198,0.196776,0.000732601,0,4294967295,nan,0.232967/0.258608/0.235897/0.272527,12.8998/19.0009/5.10807/8.15594,12.8998/19.0009/5.10807/8.15594,184.428/271.653/73.0294/116.604,1/0/0/0,1365/0/0/0,-1.38281,14.2969,-1.38281,14.2969,-1/-1/-1/-1,5.11968,4/3,196,1,1
  1350,1350,1,1,4294967295,1350,1,0,0.8,0,1350,0,450,0.8,2.82759,0.208215,0.129843,2.95892,1278,2.83647,0.207581,0.000740741,0,4294967295,nan,0.251111/0.253333/0.24/0.255556,13.1181/18.6484/5.17381/8.30402,13.1181/18.6484/5.17381/8.30402,185.395/263.554/73.1205/117.359,1/0/0/0,1350/0/0/0,-0.952148,14.1328,-0.952148,14.1328,-1/-1/-1/-1,5.14403,5/3,197,1,1
  1367,1367,1,1,4294967295,1367,1,0,0.8,0,1367,0,450,0.8,2.86976,0.204304,0.129843,2.99355,1297,2.87864,0.203722,0.000731529,0,4294967295,nan,0.250183/0.25823/0.238478/0.253109,12.6116/18.6188/4.95365/7.9254,12.6116/18.6188/4.95365/7.9254,184.346/272.155/72.4085/115.847,1/0/0/0,1367/0/0/0,-1.81934,14.6172,-1.81934,14.6172,-1/-1/-1/-1,5.01162,6/3,198,1,1
  1359,1359,1,1,4294967295,1359,1,0,0.8,0,1359,0,450,0.8,2.83647,0.205553,0.129843,2.98241,1283,2.84757,0.204805,0.000735835,0,4294967295,nan,0.264901/0.240618/0.24209/0.252391,13.0869/19.3022/5.19058/8.30899,13.0869/19.3022/5.19058/8.30899,185.67/273.849/73.6413/117.884,1/0/0/0,1359/0/0/0,-0.244751,14.1875,-0.244751,14.1875,-1/-1/-1/-1,5.18733,7/3,199,1,1

Extract sts.h5

  $ baz2bam -Q $TESTDIR/data/hqregions.fasta -o ${outPrefix}-2 -m $TESTDIR/data/metadata.xml ${bazFile} --silent  --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}-2.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1378,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.83813,0.207993,0.14427,2.84112,470,2.86865,0.206081,0,0,4294967295,nan,0.234/0.25/0.268/0.248,12.8794/17.7637/5.03734/8.08045,13.0751/17.8369/5.12589/8.19394,186.349/257.019/72.884/116.914,1/0/0/0,1378/0/0/0,-0.648438,14.4688,-0.953125,14.2188,-1/-1/-1/-1,5.08387,0/0,0,1,1
  1391,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.91748,0.193745,0.158696,2.83991,480,2.92969,0.193052,0,0,4294967295,nan,0.23/0.23/0.28/0.26,12.8964/18.8442/5.02298/8.11276,12.8267/18.3323/5.03279/8.0464,186.192/272.063/72.5193/117.128,1/0/0/0,1391/0/0/0,-1.35938,14.4375,-1.9707,14.4375,-1/-1/-1/-1,5.13099,1/0,1,1,1
  1387,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.03955,0.18987,0.129843,3.13035,499,3.04565,0.189536,0,0,4294967295,nan,0.248/0.222/0.248/0.282,12.7646/18.9275/5.06698/8.14963,13.0448/18.4117/5.15729/8.28449,184.887/274.153/73.392/118.042,1/0/0/0,1387/0/0/0,-0.625977,14.4844,-0.791992,14.125,-1/-1/-1/-1,5.16552,2/0,2,1,1
  1347,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.7832,0.211782,0.14427,2.81086,458,2.79541,0.210937,0,0,4294967295,nan,0.276/0.282/0.218/0.224,12.5228/18.4182/4.89911/7.87771,12.9646/18.8006/5.07691/8.2133,184.908/271.957/72.3384/116.319,1/0/0/0,1347/0/0/0,-1.84766,14.7656,-1.63867,14.2656,-1/-1/-1/-1,5.04268,3/0,3,1,1
  $ stsTool ${outPrefix}-2.sts.h5 | tail -5
  1384,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.03345,0.200673,0.129843,3.02795,498,3.03955,0.200259,0,0,4294967295,nan,0.248/0.262/0.222/0.268,12.5947/18.5481/4.97396/7.89317,13.0103/19.1657/5.10583/8.20566,185.673/273.439/73.3271/116.363,1/0/0/0,1384/0/0/0,0.299072,14.7422,-1.52637,14.2031,-1/-1/-1/-1,5.06475,3/3,195,1,1
  1365,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.83203,0.208367,0.14427,2.8381,467,2.85034,0.207163,0,0,4294967295,nan,0.24/0.258/0.244/0.258,12.9551/18.9944/5.19947/8.19654,12.8998/19.0009/5.10807/8.15594,185.724/272.303/74.5392/117.505,1/0/0/0,1365/0/0/0,-0.736816,14.3359,-1.38281,14.2969,-1/-1/-1/-1,5.14379,4/3,196,1,1
  1350,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.96021,0.201825,0.14427,2.8918,485,2.96021,0.201825,0,0,4294967295,nan,0.268/0.23/0.244/0.258,13.2606/18.5646/5.22781/8.46173,13.1181/18.6484/5.17381/8.30402,184.923/258.889/72.9035/118.001,1/0/0/0,1350/0/0/0,-1.01562,13.9453,-0.952148,14.1328,-1/-1/-1/-1,5.21257,5/3,197,1,1
  1367,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.92969,0.205409,0.129843,2.98515,481,2.93579,0.205061,0,0,4294967295,nan,0.234/0.24/0.242/0.284,12.7198/18.7563/4.96186/7.96,12.6116/18.6188/4.95365/7.9254,184.338/271.82/71.9081/115.358,1/0/0/0,1367/0/0/0,-1.86328,14.4922,-1.81934,14.6172,-1/-1/-1/-1,5.02486,6/3,198,1,1
  1359,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.91748,0.200647,0.14427,2.90168,481,2.93579,0.199497,0,0,4294967295,nan,0.28/0.252/0.22/0.248,13.0477/19.2189/5.17378/8.28769,13.0869/19.3022/5.19058/8.30899,185.93/273.869/73.7264/118.1,1/0/0/0,1359/0/0/0,1.21484,14.25,-0.244751,14.1875,-1/-1/-1/-1,5.22727,7/3,199,1,1

Run with diagnostic datasets turned on

  $ outPrefix="softball_snr-50_diag"
  $ baz2bam --fullHQ --diagStsH5 -o ${outPrefix} -m $TESTDIR/data/metadata.xml --adapters $TESTDIR/data/adapter.fasta ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

  $ h5ls ${outPrefix}.sts.h5/VsMF
  BaseRate                 Dataset {200, 15}
  BaseWidth                Dataset {200, 15}
  BaselineLevel            Dataset {200, 15, 1}
  BaselineStd              Dataset {200, 15, 1}
  NumFrames                Dataset {200, 15}
  Pkmid                    Dataset {200, 15, 4}
  PulseRate                Dataset {200, 15}
  PulseWidth               Dataset {200, 15}
  SnrMean                  Dataset {200, 15, 4}
  TraceAutoCorr            Dataset {200, 15}
