Extract sts.h5

  $ outPrefix="softball_snr-50"
  $ bazFile="/pbi/dept/primary/testdata/sim/softball_snr-50/softball_SNR-50_prod_hf_min_exp_meta.baz"
  $ baz2bam --fullHQ -o ${outPrefix} -m $TESTDIR/data/metadata.xml ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1209,1209,1,1,4294967295,1209,1,0,0.8,0,1209,0,665,0.8,1.8175,0.112183,0.396503,1.96712,1265,1.90168,0.108285,0,0,4294967295,nan,0.224979/0.247312/0.280397/0.247312,26.3762/49.8892/19.753/30.6053,26.3762/49.8892/19.753/30.6053,169.694/320.967/173.302/268.514,1/0/0/0,1209/0/0/0,398.25/214.875,8.77344/6.43359,398.25/214.875,8.77344/6.43359,83.375/83.375/48.1875/48.1875,19.554/26.2244,64/64,4194368,0,1
  1152,1152,1,1,4294967295,1152,1,0,0.8,0,1152,0,665,0.8,1.73181,0.117034,0.414526,1.88253,1237,1.85959,0.110482,0,0,4294967295,nan,0.241319/0.262153/0.265625/0.230903,26.4701/50.2023/19.6867/30.2927,26.4701/50.2023/19.6867/30.2927,170.402/323.178/172.566/265.535,1/0/0/0,1152/0/0/0,398.5/214.75,8.76562/6.4375,398.5/214.75,8.76562/6.4375,83.375/83.375/48.1875/48.1875,19.4514/26.5424,64/65,4194369,0,1
  1173,1173,1,1,4294967295,1173,1,0,0.8,0,1173,0,665,0.8,1.76338,0.123341,0.396503,1.92491,1268,1.90619,0.115887,0,0,4294967295,nan,0.247229/0.258312/0.243819/0.250639,26.2389/49.8014/19.817/30.6024,26.2389/49.8014/19.817/30.6024,169.426/321.569/172.315/266.098,1/0/0/0,1173/0/0/0,398.75/218.125,8.69531/6.45703,398.75/218.125,8.69531/6.45703,83.375/83.375/48.1875/48.1875,19.5071/26.1626,64/66,4194370,0,1
  1171,1171,1,1,4294967295,1171,1,0,0.8,0,1171,0,665,0.8,1.76037,0.111401,0.396503,1.97019,1247,1.87462,0.10582,0,0,4294967295,nan,0.23228/0.257899/0.259607/0.250214,26.3379/49.5695/19.7395/30.4971,26.3379/49.5695/19.7395/30.4971,170.167/320.265/172.72/266.849,1/0/0/0,1171/0/0/0,398.5/217.125,8.75/6.46094,398.5/217.125,8.75/6.46094,83.375/83.375/48.1875/48.1875,19.611/26.2292,64/67,4194371,0,1
  $ stsTool ${outPrefix}.sts.h5 | tail -5
  1122,1122,1,1,4294967295,1122,1,0,0.8,0,1122,0,665,0.8,1.68671,0.114788,0.432548,1.82832,1205,1.81149,0.108122,0,0,4294967295,nan,0.23262/0.27451/0.250446/0.242424,26.0794/49.2244/19.4322/30.1269,26.0794/49.2244/19.4322/30.1269,170.128/321.112/172.461/267.376,1/0/0/0,1122/0/0/0,398.75/211.5,8.875/6.52344,398.75/211.5,8.875/6.52344,83.375/83.375/48.2188/48.2188,19.29/26.0128,64/259,4194563,0,1
  1198,1198,1,1,4294967295,1198,1,0,0.8,0,1198,0,665,0.8,1.80096,0.117739,0.396503,1.94586,1274,1.91521,0.112062,0,0,4294967295,nan,0.245409/0.252922/0.237896/0.263773,26.3981/49.5034/19.6565/30.4136,26.3981/49.5034/19.6565/30.4136,170.659/320.032/171.994/266.119,1/0/0/0,1198/0/0/0,398.75/215.375,8.75/6.46484,398.75/215.375,8.75/6.46484,83.375/83.375/48.2188/48.2188,19.3265/26.2467,64/260,4194564,0,1
  1105,1105,1,1,4294967295,1105,1,0,0.8,0,1105,0,665,0.8,1.66115,0.119602,0.450571,1.75511,1199,1.80247,0.112374,0,0,4294967295,nan,0.238914/0.256109/0.260633/0.244344,26.4364/49.6808/19.6955/30.4844,26.4364/49.6808/19.6955/30.4844,171.217/321.761/171.566/265.548,1/0/0/0,1105/0/0/0,398.5/217.375,8.71094/6.47656,398.5/217.375,8.71094/6.47656,83.375/83.375/48.2188/48.2188,19.3635/26.3869,64/261,4194565,0,1
  1144,1144,1,1,4294967295,1144,1,0,0.8,0,1144,0,665,0.8,1.71978,0.120234,0.414526,1.87127,1213,1.82351,0.114697,0,0,4294967295,nan,0.242133/0.250874/0.266608/0.240385,26.3496/49.2051/19.7616/30.7369,26.3496/49.2051/19.7616/30.7369,170.964/319.256/171.679/267.026,1/0/0/0,1144/0/0/0,398.5/214.875,8.6875/6.48828,398.5/214.875,8.6875/6.48828,83.375/83.375/48.2188/48.2188,19.5764/26.369,64/262,4194566,0,1
  1124,1124,1,1,4294967295,1124,1,0,0.8,0,1124,0,665,0.8,1.68972,0.120124,0.432548,1.81065,1214,1.82501,0.11289,0,0,4294967295,nan,0.253559/0.266014/0.234875/0.245552,26.1291/49.404/19.5589/30.1722,26.1291/49.404/19.5589/30.1722,170.043/321.512/172.21/265.657,1/0/0/0,1124/0/0/0,398.5/214.5,8.80469/6.50781,398.5/214.5,8.80469/6.50781,83.375/83.375/48.2188/48.2188,19.2509/26.2347,64/263,4194567,0,1

Extract sts.h5

  $ baz2bam -Q $TESTDIR/data/hqregions.fasta -o ${outPrefix}-2 -m $TESTDIR/data/metadata.xml ${bazFile} --silent  --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}-2.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1209,500,2,1,4294967295,500,3,0,0.8,500,1000,255,511,0.8,1.94648,0.114974,0.396503,1.95816,517,2.02075,0.111577,0,0,4294967295,nan,0.236/0.262/0.26/0.242,26.4522/50.1231/19.9906/30.8885,26.3762/49.8892/19.753/30.6053,169.873/321.884/173.98/268.826,1/0/0/0,1209/0/0/0,398.25/214.875,8.70312/6.42188,398.25/214.875,8.77344/6.43359,83.375/83.375/48.2188/48.2188,19.7027/26.4726,64/64,4194368,0,1
  1152,500,2,1,4294967295,500,3,0,0.8,500,1000,255,511,0.8,1.85658,0.113001,0.414526,1.89862,507,1.98166,0.107223,0,0,4294967295,nan,0.242/0.272/0.252/0.234,26.4645/50.204/19.5157/30.1448,26.4701/50.2023/19.6867/30.2927,170.055/322.6/171.372/264.709,1/0/0/0,1152/0/0/0,398.25/214.25,8.78125/6.42578,398.5/214.75,8.76562/6.4375,83.375/83.375/48.2188/48.2188,19.3333/26.4713,64/65,4194369,0,1
  1173,500,2,1,4294967295,500,3,0,0.8,500,1000,255,511,0.8,1.79014,0.125974,0.414526,1.85298,498,1.94648,0.117797,0,0,4294967295,nan,0.242/0.256/0.236/0.266,26.3969/49.7757/19.8493/30.5852,26.2389/49.8014/19.817/30.6024,169.724/320.042/172.131/265.231,1/0/0/0,1173/0/0/0,398.75/218.875,8.67188/6.42969,398.75/218.125,8.69531/6.45703,83.375/83.375/48.2188/48.2188,19.5352/26.178,64/66,4194370,0,1
  1171,500,2,1,4294967295,500,3,0,0.8,500,1000,255,511,0.8,1.82532,0.115098,0.432548,1.82888,501,1.95821,0.108919,0,0,4294967295,nan,0.254/0.256/0.244/0.246,26.3216/49.6693/19.55/30.7252,26.3379/49.5695/19.7395/30.4971,170.062/320.91/171.215/269.086,1/0/0/0,1171/0/0/0,398.5/217.125,8.75781/6.46094,398.5/217.125,8.75/6.46094,83.375/83.375/48.2188/48.2188,19.6135/26.4049,64/67,4194371,0,1
  $ stsTool ${outPrefix}-2.sts.h5 | tail -5
  1122,500,2,1,4294967295,500,3,0,0.8,500,1000,255,562,0.8,1.85333,0.116128,0.396503,1.95374,602,1.96081,0.111014,0,0,4294967295,nan,0.22/0.288/0.252/0.24,25.9864/48.716/19.21/30.0427,26.0794/49.2244/19.4322/30.1269,171.246/321.031/171.839/268.741,1/0/0/0,1122/0/0/0,398.75/212.25,8.94531/6.58984,398.75/211.5,8.875/6.52344,83.375/83.375/48.2188/48.2188,19.1316/25.9059,64/259,4194563,0,1
  1198,500,2,1,4294967295,500,3,0,0.8,500,1000,255,511,0.8,2.01684,0.115048,0.360457,2.10622,545,2.13019,0.110196,0,0,4294967295,nan,0.21/0.282/0.238/0.27,26.3421/49.4464/19.8274/30.4326,26.3981/49.5034/19.6565/30.4136,170.092/319.277/172.87/265.334,1/0/0/0,1198/0/0/0,398.75/217.625,8.71875/6.45703,398.75/215.375,8.75/6.46484,83.375/83.375/48.1875/48.1875,19.3916/26.2446,64/260,4194564,0,1
  1105,500,2,1,4294967295,500,3,0,0.8,500,1000,255,562,0.8,1.77516,0.118221,0.468594,1.70684,590,1.92173,0.110979,0,0,4294967295,nan,0.244/0.238/0.266/0.252,26.1525/49.4114/19.5546/30.3878,26.4364/49.6808/19.6955/30.4844,170.195/321.56/171.867/267.08,1/0/0/0,1105/0/0/0,398.5/216.625,8.78906/6.50781,398.5/217.375,8.71094/6.47656,83.375/83.375/48.2188/48.2188,19.4514/26.2928,64/261,4194565,0,1
  1144,500,2,1,4294967295,500,3,0,0.8,500,1000,255,511,0.8,1.89567,0.116595,0.414526,1.88576,517,2.02075,0.110825,0,0,4294967295,nan,0.248/0.262/0.274/0.216,26.2688/48.8655/19.618/30.6763,26.3496/49.2051/19.7616/30.7369,170.44/317.053/171.197/267.699,1/0/0/0,1144/0/0/0,398.75/214.125,8.72656/6.48828,398.5/214.875,8.6875/6.48828,83.375/83.375/48.2188/48.2188,19.4106/26.2025,64/262,4194566,0,1
  1124,500,2,1,4294967295,500,3,0,0.8,500,1000,255,511,0.8,1.83704,0.112856,0.432548,1.83641,502,1.96212,0.107098,0,0,4294967295,nan,0.25/0.276/0.224/0.25,26.0626/49.4654/19.3169/30.1653,26.1291/49.404/19.5589/30.1722,169.814/322.298/170.834/266.774,1/0/0/0,1124/0/0/0,398.75/214.5,8.84375/6.51562,398.5/214.5,8.80469/6.50781,83.375/83.375/48.1875/48.1875,19.2053/26.1945,64/263,4194567,0,1

Run with diagnostic datasets turned on

  $ outPrefix="softball_snr-50_diag"
  $ baz2bam --fullHQ --diagStsH5 -o ${outPrefix} -m $TESTDIR/data/metadata.xml --adapters $TESTDIR/data/adapter.fasta ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

  $ h5ls ${outPrefix}.sts.h5/VsMF
  BaseRate                 Dataset {200, 12}
  BaseWidth                Dataset {200, 12}
  BaselineLevel            Dataset {200, 12, 2}
  BaselineStd              Dataset {200, 12, 2}
  NumFrames                Dataset {200, 12}
  Pkmid                    Dataset {200, 12, 4}
  PulseRate                Dataset {200, 12}
  PulseWidth               Dataset {200, 12}
  SnrMean                  Dataset {200, 12, 4}
  TraceAutoCorr            Dataset {200, 12}
