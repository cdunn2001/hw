Extract sts.h5

  $ outPrefix="softball_snr-50"
  $ bazFile="/pbi/dept/primary/sim/kestrel/kestrel-zmw-features/prod.baz"
  $ baz2bam --fullHQ -o ${outPrefix} -m $TESTDIR/data/metadata.xml ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1625,1625,1,1,4294967295,1625,1,0,0.8,0,1625,0,532,0.8,2.89588,0.201552,0.129843,3.01828,1557,2.92405,0.199778,0.000615385,0,4294967295,nan,0.252308/0.246154/0.243077/0.258462,12.9438/17.9586/5.13842/8.19329,12.9438/17.9586/5.13842/8.19329,185.258/257.032/73.5437/117.266,1/0/0/0,1625/0/0/0,-1.16406,14.3125,-1.16406,14.3125,-1/-1/-1/-1,4.84475,0/0,0,1,1
  1657,1657,1,1,4294967295,1657,1,0,0.8,0,1657,0,532,0.8,2.96161,0.192652,0.129843,3.10158,1587,2.98039,0.191583,0.0006035,0,4294967295,nan,0.254677/0.235969/0.264333/0.245021,12.8571/18.0873/5.08277/8.10526,12.8571/18.0873/5.08277/8.10526,185.223/260.571/73.2237/116.766,1/0/0/0,1657/0/0/0,-0.49585,14.4062,-0.49585,14.4062,-1/-1/-1/-1,5.00455,0/1,1,1,1
  1632,1632,1,1,4294967295,1632,1,0,0.8,0,1632,0,532,0.8,2.89588,0.201097,0.129843,3.02243,1553,2.91654,0.199914,0.000612745,0,4294967295,nan,0.259804/0.242647/0.241422/0.256127,12.8768/18.3519/5.05651/8.09966,12.8768/18.3519/5.05651/8.09966,184.501/262.948/72.4503/116.053,1/0/0/0,1632/0/0/0,-2.0293,14.3281,-2.0293,14.3281,-1/-1/-1/-1,5.07324,0/2,2,1,1
  1589,1589,1,1,4294967295,1589,1,0,0.8,0,1589,0,532,0.8,2.81701,0.206254,0.14427,2.85361,1513,2.84142,0.204678,0.000629327,0,4294967295,nan,0.265576/0.271869/0.221523/0.241032,13.014/18.9314/5.09599/8.15544,13.014/18.9314/5.09599/8.15544,184.534/268.441/72.2595/115.642,1/0/0/0,1589/0/0/0,-2.17383,14.1797,-2.17383,14.1797,-1/-1/-1/-1,5.12691,0/3,3,1,1
  $ stsTool ${outPrefix}.sts.h5 | tail -5
  1647,1647,1,1,4294967295,1647,1,0,0.8,0,1647,0,532,0.8,2.971,0.191423,0.129843,3.11345,1594,2.99354,0.19006,0.000607165,0,4294967295,nan,0.251973/0.248937/0.256831/0.242259,13.0206/19.2191/5.11717/8.23684,13.0206/19.2191/5.11717/8.23684,184.221/271.92/72.4/116.538,1/0/0/0,1647/0/0/0,-1.93457,14.1484,-1.93457,14.1484,-1/-1/-1/-1,5.033,0/195,195,1,1
  1619,1619,1,1,4294967295,1619,1,0,0.8,0,1619,0,532,0.8,2.89588,0.19757,0.14427,2.92611,1562,2.93344,0.195266,0.000617665,0,4294967295,nan,0.235948/0.255713/0.242125/0.266214,12.9395/19.0831/5.12927/8.19504,12.9395/19.0831/5.12927/8.19504,185.197/273.127/73.4127/117.292,1/0/0/0,1619/0/0/0,-0.499268,14.3125,-0.499268,14.3125,-1/-1/-1/-1,5.15594,0/196,196,1,1
  1602,1602,1,1,4294967295,1602,1,0,0.8,0,1602,0,532,0.8,2.86584,0.205696,0.129843,2.981,1534,2.88086,0.204662,0.00062422,0,4294967295,nan,0.245318/0.250312/0.245318/0.259051,12.6278/18.1267/5.0043/8.09176,12.6278/18.1267/5.0043/8.09176,183.005/262.696/72.5233/117.267,1/0/0/0,1602/0/0/0,-2.60352,14.4922,-2.60352,14.4922,-1/-1/-1/-1,4.79608,0/197,197,1,1
  1612,1612,1,1,4294967295,1612,1,0,0.8,0,1612,0,532,0.8,2.88649,0.203634,0.129843,2.99944,1551,2.91279,0.20199,0.000620347,0,4294967295,nan,0.246898/0.256824/0.237593/0.258685,12.803/18.9596/5.04029/8.08366,12.803/18.9596/5.04029/8.08366,183.844/272.248/72.3754/116.076,1/0/0/0,1612/0/0/0,-2.08008,14.3594,-2.08008,14.3594,-1/-1/-1/-1,5.07077,0/198,198,1,1
  1625,1625,1,1,4294967295,1625,1,0,0.8,0,1625,0,532,0.8,2.89588,0.201993,0.129843,3.01427,1554,2.91842,0.200552,0.000615385,0,4294967295,nan,0.259077/0.236923/0.254769/0.249231,12.9266/19.0776/5.04642/8.14149,12.9266/19.0776/5.04642/8.14149,184.305/272.004/71.9509/116.08,1/0/0/0,1625/0/0/0,-1.83301,14.2578,-1.83301,14.2578,-1/-1/-1/-1,4.91528,0/199,199,1,1

Extract sts.h5

  $ baz2bam -Q $TESTDIR/data/hqregions.fasta -o ${outPrefix}-2 -m $TESTDIR/data/metadata.xml ${bazFile} --silent  --whitelistZmwId=0-199 --enableBarcodedAdapters=False

Compare sts.h5

  $ stsTool ${outPrefix}-2.sts.h5 | head -5
  NumBases,ReadLength,Loading,Productivity,MedianInsertLength,InsertReadLength,ReadType,LoopOnly,ReadScore,HQRegionStart,HQRegionEnd,HQRegionStartTime,HQRegionEndTime,HQRegionScore,BaseRate,BaseWidth,BaseIpd,LocalBaseRate,NumPulses,PulseRate,PulseWidth,Pausiness,IsControl,ControlReadLength,ControlReadAccuracy,BaseFraction,HQRegionSnrMean,SnrMean,HQPkmid,InsertionCounts,InsertionLengths,HQBaselineLevel,HQBaselineStd,BaselineLevel,BaselineStd,DyeAngle,HQChannelMinSnr,HoleXY,HoleNumber,UnitFeature,HoleType
  1625,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.93579,0.203378,0.14427,2.87886,484,2.9541,0.20225,0,0,4294967295,nan,0.248/0.252/0.25/0.25,13.2425/17.278/5.2038/8.36898,12.9438/17.9586/5.13842/8.19329,186.74/243.647/73.3817/118.016,1/0/0/0,1625/0/0/0,-0.644043,14.1016,-1.16406,14.3125,-1/-1/-1/-1,5.11687,0/0,0,1,1
  1657,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.00293,0.192623,0.14427,2.97085,495,3.02124,0.191664,0,0,4294967295,nan,0.278/0.24/0.256/0.226,12.71/18.5608/4.97438/7.96971,12.8571/18.0873/5.08277/8.10526,186.678/272.612/73.0612/117.055,1/0/0/0,1657/0/0/0,0.0878296,14.6875,-0.49585,14.4062,-1/-1/-1/-1,5.0442,0/1,1,1,1
  1632,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.00903,0.204479,0.129843,2.99346,496,3.02734,0.203518,0,0,4294967295,nan,0.238/0.232/0.23/0.3,12.722/18.902/4.94017/7.99079,12.8768/18.3519/5.05651/8.09966,182.679/271.421/70.9377/114.743,1/0/0/0,1632/0/0/0,-2.20508,14.3594,-2.0293,14.3281,-1/-1/-1/-1,4.99705,0/2,2,1,1
  1589,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.89917,0.207512,0.14427,2.84501,477,2.91138,0.206751,0,0,4294967295,nan,0.246/0.268/0.23/0.256,12.7867/18.6998/4.91768/7.93324,13.014/18.9314/5.09599/8.15544,184.309/269.54/70.8838/114.35,1/0/0/0,1589/0/0/0,-3.0293,14.4141,-2.17383,14.1797,-1/-1/-1/-1,5.0272,0/3,3,1,1
  $ stsTool ${outPrefix}-2.sts.h5 | tail -5
  1647,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.03955,0.188502,0.14427,3.00767,499,3.04565,0.18822,0,0,4294967295,nan,0.29/0.242/0.22/0.248,13.0419/19.2093/5.12383/8.23272,13.0206/19.2191/5.11717/8.23684,184.523/271.782/72.4942/116.48,1/0/0/0,1647/0/0/0,-1.93457,14.1484,-1.93457,14.1484,-1/-1/-1/-1,5.10812,0/195,195,1,1
  1619,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.84424,0.200466,0.14427,2.90321,474,2.89307,0.197501,0,0,4294967295,nan,0.264/0.26/0.242/0.234,12.8798/18.9048/5.01791/8.14801,12.9395/19.0831/5.12927/8.19504,185.55/272.347/72.2893/117.382,1/0/0/0,1619/0/0/0,-0.967773,14.4062,-0.499268,14.3125,-1/-1/-1/-1,5.17372,0/196,196,1,1
  1602,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,3.06396,0.197692,0.129843,3.05553,503,3.07007,0.197298,0,0,4294967295,nan,0.25/0.236/0.268/0.246,12.1089/17.1516/4.79355/7.69551,12.6278/18.1267/5.0043/8.09176,183.052/259.284/72.465/116.334,1/0/0/0,1602/0/0/0,-1.00293,15.1172,-2.60352,14.4922,-1/-1/-1/-1,4.51805,0/197,197,1,1
  1612,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.97241,0.203698,0.129843,3.00047,492,3.00293,0.201849,0,0,4294967295,nan,0.244/0.238/0.228/0.29,12.4277/18.354/4.87604/7.85395,12.803/18.9596/5.04029/8.08366,183.794/271.439/72.1121/116.153,1/0/0/0,1612/0/0/0,-2.08008,14.7891,-2.08008,14.3594,-1/-1/-1/-1,4.86378,0/198,198,1,1
  1625,500,2,1,4294967295,500,3,0,0.8,500,1000,163,327,0.8,2.88696,0.208574,0.129843,2.95721,477,2.91138,0.206836,0,0,4294967295,nan,0.266/0.218/0.258/0.258,12.6894/18.6472/4.90814/8.07003,12.9266/19.0776/5.04642/8.14149,184.691/271.404/71.4364/117.457,1/0/0/0,1625/0/0/0,-1.83301,14.5547,-1.83301,14.2578,-1/-1/-1/-1,4.71306,0/199,199,1,1

Run with diagnostic datasets turned on

  $ outPrefix="softball_snr-50_diag"
  $ baz2bam --fullHQ --diagStsH5 -o ${outPrefix} -m $TESTDIR/data/metadata.xml --adapters $TESTDIR/data/adapter.fasta ${bazFile} --silent --whitelistZmwId=0-199 --enableBarcodedAdapters=False

  $ h5ls ${outPrefix}.sts.h5/VsMF
  BaseRate                 Dataset {200, 15}
  BaseWidth                Dataset {200, 15}
  BaselineLevel            Dataset {200, 15, 1}
  BaselineStd              Dataset {200, 15, 1}
  NumFrames                Dataset {200, 15}
  Pkmid                    Dataset {200, 15, 4}
  PulseRate                Dataset {200, 15}
  PulseWidth               Dataset {200, 15}
  SnrMean                  Dataset {200, 15, 4}
  TraceAutoCorr            Dataset {200, 15}
